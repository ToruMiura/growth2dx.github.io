<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>プレイ記録アプリ</title>
  <style>
   /* ラジオボタンを横並びにするためのスタイル */
   input[type="radio"] {
     display: inline-block;
     margin-right: 3px; /* ラジオボタン間の余白 */
   }
   /* 直近10回分の記録テーブルのスタイル */
   #recentRecords {
     border-collapse: collapse; /* セルの境界線を一つにまとめる */
     width: 100%; /* テーブルの幅を親要素に合わせる */
     margin-top: 20px; /* テーブルの上の余白 */
   }

   #recentRecords th, #recentRecords td {
     border: 1px solid #000; /* 黒の罫線 */
     padding: 8px; /* セル内の余白 */
     text-align: left; /* テキストを左揃えに */
   }

   #recentRecords th {
     background-color: #f2f2f2; /* ヘッダーの背景色 */
   } 
   .difficulty-table td {
     cursor: pointer;
     border: 1px solid #000;
     text-align: center;
   }
   .selected {
     background-color: #f2f2f2;
   }
    /* 難易度の項目群を囲むdivのスタイル */
    .difficulty-container {
      max-width: calc(100% - 100px); /* 画面の幅から100px引いた値を最大幅とする */
      margin: auto; /* 中央寄せ */
  }
 </style>
</head>
<body>
  <h1>プレイ記録を追加</h1>
  <form id="playRecordForm" onsubmit="addRecord(); return false;">
    <label>難易度：</label><br>
    <div class="difficulty-container">
      <table class="difficulty-table">
        <tr>
          <td onclick="selectDifficulty('8', this)">8</td>
          <td onclick="selectDifficulty('9', this)">9</td>
          <td onclick="selectDifficulty('10', this)">10</td>
          <td onclick="selectDifficulty('11', this)">11</td>
          <td onclick="selectDifficulty('12', this)">12</td>
        </tr>
      </table>
    </div>
    <input type="hidden" id="selectedDifficulty" name="difficulty">
    <br>
    <br>

    <label>クリア種別：</label><br>
    <!-- クリア種別のラジオボタン（横並び） -->
    <input type="radio" id="typeF" name="clearType" value="F">
    <label for="typeF">F</label>

    <input type="radio" id="typeAE" name="clearType" value="AE">
    <label for="typeAE">AE</label>

    <input type="radio" id="typeE" name="clearType" value="E">
    <label for="typeE">E</label>

    <input type="radio" id="typeC" name="clearType" value="C">
    <label for="typeC">C</label>

    <input type="radio" id="typeH" name="clearType" value="H">
    <label for="typeH">H</label>

    <input type="radio" id="typeEH" name="clearType" value="EH">
    <label for="typeEH">EH</label>
    <br>
    <br>
    
    <label>クリアランク：</label><br>
    <!-- クリアランクのラジオボタン（横並び） -->
    <input type="radio" id="rankC" name="clearRank" value="C">
    <label for="rankC">C</label>

    <input type="radio" id="rankB" name="clearRank" value="B">
    <label for="rankB">B</label>

    <input type="radio" id="rankBplus" name="clearRank" value="B+">
    <label for="rankBplus">B+</label>

    <input type="radio" id="rankA" name="clearRank" value="A">
    <label for="rankA">A</label>

    <input type="radio" id="rankAplus" name="clearRank" value="A+">
    <label for="rankAplus">A+</label>
    <br>

    <input type="radio" id="rankAA" name="clearRank" value="AA">
    <label for="rankAA">AA</label>

    <input type="radio" id="rankAAplus" name="clearRank" value="AA+">
    <label for="rankAAplus">AA+</label>

    <input type="radio" id="rankAAA" name="clearRank" value="AAA">
    <label for="rankAAA">AAA</label>
    <br>
    <br>

    <!-- ミスカウント -->
    <label for="missCount">ミス数: <span id="missCountValue"> 0 </span></label>
    <div style="display: flex; align-items: center; margin-top: 10px; gap: 40px;">
      <button type="button" onclick="changeMissCount(-1)" style="margin-left: 20px;">−1</button>
      <input type="range" id="missCount" name="missCount" min="0" max="200" value="0" style="flex-grow: 1;" oninput="updateMissCountValue(this.value);">
      <button type="button" onclick="changeMissCount(1)" style="margin-right: 20px;">+1</button>
    </div>
    <br><br>

    <!-- 皿曲の確認 -->
    <label for="scratchSong">スクラッチ曲：</label>
    <input type="checkbox" id="scratchSong" name="scratchSong" value="true"><br><br>

    <!-- 他の記録項目の入力フォーム -->

    <button type="submit">記録を追加</button>
  </form>
  <h2>直近10回分の記録</h2>
  <table id="recentRecords">
    <thead>
      <tr>
        <th>回数</th>
        <th>難易度</th>
        <th>クリア種別</th>
        <th>クリアランク</th>
        <th>ミス数</th>
        <th>スクラッチ曲</th>
      </tr>
    </thead>
    <tbody>
      <!-- ここにJavaScriptで動的に記録が追加されます -->
    </tbody>
  </table>

  <script>
    let recordCounter = 1;

    function selectDifficulty(difficulty, element) {
      // 既存の選択をクリア
      const cells = document.querySelectorAll('.difficulty-table td');
      cells.forEach(cell => cell.classList.remove('selected'));
      
      // 新しい選択をハイライト
      element.classList.add('selected');
      
      // 選択された難易度をinputに設定
      document.getElementById('selectedDifficulty').value = difficulty;
    }
    
    function updateMissCountValue(value) {
    document.getElementById("missCountValue").textContent = value;
    document.getElementById("missCountSlider").value = value;
    }

    function changeMissCount(change) {
    var slider = document.getElementById("missCount");
    var currentValue = parseInt(slider.value);
    var newValue = currentValue + change;
    if (newValue >= 0 && newValue <= 200) {
        slider.value = newValue;
        updateMissCountValue(newValue);
    }
}
       
    function addRecord() {
      // フォームから値を取得
      const difficulty = document.getElementById('selectedDifficulty').value;
      const clearType = document.querySelector('input[name="clearType"]:checked').value;
      const clearRank = document.querySelector('input[name="clearRank"]:checked').value;
      const missCount = document.getElementById('missCount').value;
      const scratchSong = document.getElementById('scratchSong').checked ? "Yes" : "No";

      // テーブルに新しい行を追加
      const table = document.getElementById('recentRecords').getElementsByTagName('tbody')[0];
      const newRow = table.insertRow();
      newRow.insertCell(0).appendChild(document.createTextNode(recordCounter));
      newRow.insertCell(1).appendChild(document.createTextNode(difficulty));
      newRow.insertCell(2).appendChild(document.createTextNode(clearType));
      newRow.insertCell(3).appendChild(document.createTextNode(clearRank));
      newRow.insertCell(4).appendChild(document.createTextNode(missCount));
      newRow.insertCell(5).appendChild(document.createTextNode(scratchSong));

      // フォームの値をリセット
      document.getElementById('playRecordForm').reset();
      // スライダーの値をリセット
      document.getElementById('missCount').value = 0;
      // ミス数の表示を明示的にリセット
      document.getElementById('missCountValue').textContent = '0';
      
      // 表示回数を更新
      recordCounter++;
      if (recordCounter > 10) {
        recordCounter = 1;
      }
    }
  </script>
</body>
</html>
